---
phase: 01-mode-rename-and-live-voice-session
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - push-to-talk.py
  - indicator.py
  - README.md
autonomous: true

must_haves:
  truths:
    - "Settings combo box shows 'Dictate (instant typing)' instead of 'Live (instant typing)'"
    - "Voice commands 'dictate mode' / 'go dictate' / 'dictation mode' switch to dictate mode"
    - "Old voice commands 'go live' / 'live mode' / 'going live' no longer set dictation_mode to 'live'"
    - "Default config value for dictation_mode is 'dictate'"
    - "Users with 'live' saved in config.json are auto-migrated to 'dictate'"
    - "QuickControlWindow radio buttons show 'Manual' for dictate instead of live"
    - "All mode_names dicts map 'dictate' instead of 'live'"
  artifacts:
    - path: "push-to-talk.py"
      provides: "Renamed dictation mode defaults, voice commands, and config migration"
      contains: "dictation_mode.*dictate"
    - path: "indicator.py"
      provides: "Renamed UI labels, combo box, QuickControlWindow modes"
      contains: "dictate.*Dictate"
    - path: "README.md"
      provides: "Updated documentation reflecting dictation modes"
  key_links:
    - from: "push-to-talk.py"
      to: "indicator.py"
      via: "config.json dictation_mode value"
      pattern: "dictation_mode.*dictate"
    - from: "indicator.py"
      to: "push-to-talk.py"
      via: "config.json written by settings UI, read by service"
      pattern: "mode_combo.*dictate"
---

<objective>
Rename all references to the "live" dictation mode to "dictate" across the codebase, config defaults, UI, and voice commands. Add a config migration so existing users with `dictation_mode: "live"` are automatically updated to `"dictate"`.

Purpose: Free up the "live" name for the new real-time voice session mode (Plan 02). The rename must land first so there is no naming collision.
Output: All three files updated with consistent "dictate" naming. Config migration in both `push-to-talk.py` and `indicator.py`.
</objective>

<execution_context>
@/home/ethan/.claude/get-shit-done/workflows/execute-plan.md
@/home/ethan/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-mode-rename-and-live-voice-session/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename dictation mode from "live" to "dictate" in push-to-talk.py and indicator.py</name>
  <files>push-to-talk.py, indicator.py</files>
  <action>
In `push-to-talk.py`:

1. **Default config** (line 228): Change `"dictation_mode": "live"` to `"dictation_mode": "dictate"`. Update the comment to `# "dictate", "prompt", or "stream"`.

2. **Config migration**: In `load_config()`, after the line `return {**default, **config}` (line 245), add migration logic BEFORE the return. The pattern:
```python
merged = {**default, **config}
# Migrate old "live" dictation mode to "dictate"
if merged.get('dictation_mode') == 'live':
    merged['dictation_mode'] = 'dictate'
    save_config(merged)
return merged
```
This must come BEFORE the `return` statement so it applies to loaded configs.

3. **Voice commands** (lines 1006-1013): Change the "go live" block:
   - Trigger phrases: `['dictate mode', 'go dictate', 'dictation mode']` (instead of `['go live', 'live mode', 'going live']`)
   - Set `self.config['dictation_mode'] = 'dictate'`
   - Notification text: `'Dictate mode activated'`
   - Print statement: `"Voice command: switching to dictate mode"`

4. **Stream mode voice commands** (lines 1217-1224): Same rename pattern:
   - Trigger phrases: `['dictate mode', 'go dictate', 'dictation mode']`
   - Set `self.config['dictation_mode'] = 'dictate'`
   - Notification text: `'Dictate mode activated'`
   - Print statement: `"Stream: switching to dictate mode"`

In `indicator.py`:

5. **Default config** (line 67): Change `"dictation_mode": "live"` to `"dictation_mode": "dictate"`.

6. **Config migration**: In indicator.py's `load_config()`, add the same migration after merging defaults:
```python
merged = {**default, **config}
if merged.get('dictation_mode') == 'live':
    merged['dictation_mode'] = 'dictate'
    # Don't save from indicator — push-to-talk.py handles persistence
return merged
```

7. **Settings combo box** (line 403): Change `self.mode_combo.append("live", "Live (instant typing)")` to `self.mode_combo.append("dictate", "Dictate (instant typing)")`.

8. **Settings combo default** (line 406): Change `config.get('dictation_mode', 'live')` to `config.get('dictation_mode', 'dictate')`.

9. **Info text** (line 417): Update the help text from `"Live: types after release."` to `"Dictate: types after release."` and change `"Voice: 'go live/stream/prompt'"` to `"Voice: 'go dictate/stream/prompt'"`.

10. **PopupWindow mode_names** (line 1025): Change `'live': 'Manual'` to `'dictate': 'Manual'`. Also update the fallback default on line 1026 from `'live'` to `'dictate'`.

11. **QuickControlWindow modes list** (line 1387-1391): Change `('live', 'Manual', 'types after release')` to `('dictate', 'Manual', 'types after release')`.

12. **QuickControlWindow default** (line 1385): Change `config.get('dictation_mode', 'live')` to `config.get('dictation_mode', 'dictate')`.

13. **QuickControlWindow on_mode_toggled mode_names** (line 1467): Change `'live': 'Manual'` to `'dictate': 'Manual'`.
  </action>
  <verify>
Run these checks:
```bash
cd /home/ethan/code/push-to-talk
# Verify no remaining "live" dictation mode references (should only match new live AI mode or unrelated)
grep -n "dictation_mode.*live\|'live'.*instant\|'live'.*Manual\|go live.*dictation" push-to-talk.py indicator.py | grep -v "# Migrate\|== 'live'" && echo "FAIL: stale live references" || echo "PASS: no stale live refs"
# Verify "dictate" is present in both files
grep -c "dictate" push-to-talk.py indicator.py
# Verify migration logic exists
grep -n "dictation_mode.*==.*live" push-to-talk.py indicator.py
```
  </verify>
  <done>
All dictation mode references changed from "live" to "dictate" in both files. Config migration auto-converts old "live" values. Voice commands use "dictate mode" / "go dictate" / "dictation mode". Settings combo shows "Dictate (instant typing)". QuickControlWindow and PopupWindow both use "dictate" key.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update README.md with dictation mode rename</name>
  <files>README.md</files>
  <action>
The README currently doesn't mention dictation modes by name (no "live mode" string), but the SOP requires keeping docs in sync. Add a "Dictation Modes" subsection under "Usage" to document the three modes and their voice commands:

After the "Status Indicator" section (around line 55), add:

```markdown
### Dictation Modes
- **Dictate** - Types text after you release the key (default)
- **Prompt** - Shows a preview dialog before typing
- **Stream** - Types while you speak in real-time chunks

Switch modes by voice:
- `"dictate mode"` or `"go dictate"`
- `"prompt mode"` or `"go prompt"`
- `"stream mode"` or `"go stream"`

Or use the Settings window (right-click the status dot).
```

Also verify the website files don't need changes. Per research, `push-to-talk-page.blade.php` already shows "Dictate" at line 648, and `push-to-talk.blade.php` uses "Dictate" at line 22. No website changes needed.
  </action>
  <verify>
```bash
grep -c "Dictate" /home/ethan/code/push-to-talk/README.md
# Should return >= 1
grep "dictate mode" /home/ethan/code/push-to-talk/README.md
# Should find the voice command reference
```
  </verify>
  <done>
README documents the three dictation modes with voice commands. Website files confirmed already showing "Dictate" — no changes needed there.
  </done>
</task>

</tasks>

<verification>
1. `grep -rn "dictation_mode.*live" push-to-talk.py indicator.py` returns ONLY migration lines (the `== 'live'` check), not any default/assignment lines
2. `grep -n "'dictate'" push-to-talk.py indicator.py` shows the new defaults, voice commands, and UI entries
3. `python3 -c "import json; print(json.dumps({'dictation_mode': 'live'}))"` simulated old config — after migration, value should be "dictate"
4. No syntax errors: `python3 -c "import py_compile; py_compile.compile('push-to-talk.py'); py_compile.compile('indicator.py'); print('OK')"` returns OK
</verification>

<success_criteria>
- "Dictate" appears in settings combo box where "Live" was
- Voice commands "dictate mode" / "go dictate" switch to dictate mode
- Old configs with "live" auto-migrate to "dictate"
- Default config is "dictate" in both files
- README documents dictation modes
- No Python syntax errors in modified files
</success_criteria>

<output>
After completion, create `.planning/phases/01-mode-rename-and-live-voice-session/01-01-SUMMARY.md`
</output>
